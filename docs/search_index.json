[["index.html", "Mapy tematyczne w R Wstp", " Mapy tematyczne w R Tomasz Klimanek Katedra Statystyki, Uniwersytet Ekonomiczny w Poznaniutomasz.klimanek@ue.poznan.pl 2021-04-12 Wstp Na poprzednich zajciach przedstawione zostay metody tworzenia map konturowych dla rónych podziaów administracyjnych i statystycznych. W tym celu wykorzystano pakiet sf. Natomiast gównym celem niniejszych zaje bdzie stworzenie wykresów mapowych, tzw. kartogramów tj. map tematycznych przedstawiajcych natzenie danego zjawiska w poszczególnych jednostkach podziau przestrzennego. Przedstawienie sekwencyjne tematyki map, tzn. najpierw mapy konturowe, a w dalszej kolejnoci mapy tematyczne wynika std, e czsto wprowadza si podzia zbiorów sucych tworzeniu map na dwa rodzaje, w zalenoci od danych, jakie zawieraj: dane przestrzenne (suce do narysowania mapy konturowej, zawierajce informacje o wspórzdnych, ich przeksztaceniach, zastosowanych ukadach wspórzdnych, etc.) dane atrybutowe (przechowujce wartoci zjawisk, które maj by wywietlone na mapach w powizaniu z identyfikatorami obiektów mapowych: poligonów, linii, punktów). "],["wykorzystywane-pakiety.html", "Wykorzystywane pakiety", " Wykorzystywane pakiety W celu stworzenia map tematycznych potrzebne bd nastpujce pakiety, które naley zainstalowa: install.packages(&quot;readxl&quot;) install.packages(&quot;sf&quot;) install.packages(&quot;dplyr&quot;) install.packages(&quot;classInt&quot;) install.packages(&quot;RColorBrewer&quot;) install.packages(&quot;ggplot2&quot;) A nastpnie wczytujemy odpowiednie biblioteki library(&quot;readxl&quot;) library(&quot;sf&quot;) library(&quot;dplyr&quot;) library(&quot;classInt&quot;) library(&quot;RColorBrewer&quot;) library(&quot;ggplot2&quot;) "],["tworzenie-prostego-kartogramu-w-1.html", "Tworzenie prostego kartogramu w.1", " Tworzenie prostego kartogramu w.1 Korzystajc z publikacji Bezrobocie rejestrowane. I-IV kwarta 2020 roku, spróbujmy stworzy prosty kartogram zamieszczony na stronie 9 tego opracowania. W pierwszej kolejnoci wczytujemy dane przestrzenne za pomoc funkcji read_sf z pakietu sf, a nastpnie dane atrybutowe dla województw za pomoc funkcji read_xlsx z pakeitu readxl. woj&lt;-read_sf(&quot;gadm36_POL_1.shp&quot;) unempl&lt;-read_xlsx(&quot;woj_un_rate.xlsx&quot;) Dodatkowo tworzymy w zbiorze unempl dwuznakowy kod województwa za pomoc funkcji substr i zapisujemy go w zmiennej o nazwie kod_woj2 unempl$KOD_WOJ2&lt;-substr(unempl$KOD_WOJ,1,2) czymy oba obiekty w jeden zbiór za pomoc funkcji merge deklarujc nazwy zmiennych, po których czymy obydwa zbiory. dane&lt;-merge(woj,unempl,by.x=&quot;CC_1&quot;,by.y=&quot;KOD_WOJ2&quot;) Kolejnym krokiem bdzie podzia zmiennoci badanej cech na przedziay. W tym przypadku stworzymy 4 klasy o takich granicach jak w przypadku publikacji GUS. klasy&lt;-classIntervals(dane$UN_RATE,n=4,style=&quot;fixed&quot;,fixedBreaks=c(3.7,5.3,6.9,8.5,10.1)) Nastpnie z pakietu RColorBrewer dobieramy palet kolorów zblion do tej uytej w publikacji GUS. kolory&lt;-brewer.pal(4,&quot;BuGn&quot;) czymy wyznaczone klasy z kolorami z dobranej palety kol_klas&lt;-findColours(klasy,kolory) Generujemy wykres, definiujc legend par(mar=rep(0,4),mai=rep(0,4)) plot(dane[&quot;UN_RATE&quot;],col=kol_klas) legend(&quot;bottomleft&quot;, c(paste0(&quot;[&quot;, klasy$brks[1], &quot; - &quot;, klasy$brks[2], &quot;]&quot;), paste0(&quot;[&quot;, klasy$brks[2], &quot; - &quot;,klasy$brks[3], &quot;]&quot;), paste0(&quot;[&quot;, klasy$brks[3], &quot; - &quot;,klasy$brks[4], &quot;]&quot;), paste0(&quot;[&quot;, klasy$brks[4], &quot; - &quot;,klasy$brks[5], &quot;]&quot;)), fill=attr(kol_klas, &quot;palette&quot;), cex=1, bty=&quot;n&quot;) "],["tworzenie-prostego-kartogramu-w-2.html", "Tworzenie prostego kartogramu w.2", " Tworzenie prostego kartogramu w.2 Korzystajc z publikacji Komunikat o sytuacji spoeczno-gospodarczej województwa wielkopolskiego - luty 2021 r., spróbujmy stworzy prosty kartogram zamieszczony na stronie 16 tego opracowania. W pierwszej kolejnoci wczytujemy dane przestrzenne za pomoc funkcji read_sf z pakietu sf, a nastpnie dane atrybutowe dla powiatów województwa wielkopolskiego za pomoc funkcji read_xlsx z pakeitu readxl. pow&lt;-read_sf(&quot;dane/gadm36_POL_2.shp&quot;) mieszk&lt;-read_xlsx(&quot;dane/wlkp_mieszk.xlsx&quot;) Ograniczamy zbiór danych przestrzennych do powiatóW województwa wielkopolskiego i dodatkowo tworzymy w zbiorze mieszk czteroznakowy kod województwa za pomoc funkcji substr i zapisujemy go w zmiennej o nazwie kod_pow2 pow_wlkp&lt;-pow[pow$NAME_1==&#39;Wielkopolskie&#39;,] mieszk$KOD_POW2&lt;-substr(mieszk$KOD_POW,1,4) czymy oba obiekty w jeden zbiór za pomoc funkcji merge deklarujc nazwy zmiennych, po których czymy obydwa zbiory. dane&lt;-merge(pow_wlkp,mieszk,by.x=&quot;CC_2&quot;,by.y=&quot;KOD_POW2&quot;) Kolejnym krokiem bdzie podzia zmiennoci badanej cech na przedziay. W tym przypadku stworzymy 5 klas o granicach opartych o przedziay kwintylowe (w kadym bdzie 20% wszystkich obiektów - powiatów). klasy&lt;-classIntervals(dane$MIESZK,n=5,style=&quot;quantile&quot;) Nastpnie z pakietu RColorBrewer dobieramy palet kolorów zblion do tej uytej w publikacji GUS. kolory&lt;-brewer.pal(5,&quot;Purples&quot;) czymy wyznaczone klasy z kolorami z dobranej palety kol_klas&lt;-findColours(klasy,kolory) Generujemy wykres, definiujc legend par(mar=rep(0,4),mai=rep(0,4)) plot(dane[&quot;MIESZK&quot;],col=kol_klas, main=&quot;Mapa 2. Mieszkania oddane do uytkowania wedug powiatów w okresie stycze-luty 2021 r.&quot;) legend(&quot;bottomleft&quot;, c(paste0(&quot;[&quot;, klasy$brks[1], &quot; - &quot;, klasy$brks[2], &quot;]&quot;), paste0(&quot;[&quot;, klasy$brks[2], &quot; - &quot;,klasy$brks[3], &quot;]&quot;), paste0(&quot;[&quot;, klasy$brks[3], &quot; - &quot;,klasy$brks[4], &quot;]&quot;), paste0(&quot;[&quot;, klasy$brks[4], &quot; - &quot;,klasy$brks[5], &quot;]&quot;), paste0(&quot;[&quot;, klasy$brks[5], &quot; - &quot;,klasy$brks[6], &quot;]&quot;)), fill=attr(kol_klas, &quot;palette&quot;), cex=1, bty=&quot;n&quot;) "],["tworzenie-prostego-kartogramu-zadanie-1.html", "Tworzenie prostego kartogramu - zadanie 1", " Tworzenie prostego kartogramu - zadanie 1 Korzystajc z publikacji Metropolia Pozna 2010-2019 oraz danych w Banku Danych Lokalnych(https://bdl.stat.gov.pl/BDL/start) spróbuj stworzy prosty kartogram zamieszczony na stronie 22 tego opracowania. "],["edycja-kartogramu.html", "Edycja kartogramu", " Edycja kartogramu Na bazie kartogramu z czci Tworzenie prostego kartogramu w.1, zmodyfikuj go dodajc: tytu wykresu, nazwy województw, wartoci zmiennych, liczb obiektów w legendzie. Powtórzenie kodu z czci Tworzenie prostego kartogramu w.1 woj&lt;-read_sf(&quot;dane/gadm36_POL_1.shp&quot;) unempl&lt;-read_xlsx(&quot;dane/woj_un_rate.xlsx&quot;) unempl$KOD_WOJ2&lt;-substr(unempl$KOD_WOJ,1,2) dane&lt;-merge(woj,unempl,by.x=&quot;CC_1&quot;,by.y=&quot;KOD_WOJ2&quot;) klasy&lt;-classIntervals(dane$UN_RATE,n=4,style=&quot;fixed&quot;,fixedBreaks=c(3.7,5.3,6.9,8.5,10.1)) kolory&lt;-brewer.pal(4,&quot;BuGn&quot;) kol_klas&lt;-findColours(klasy,kolory) Do wyznaczenia wspórzdnych centroidów województw stosujemy funkcje st_centroid oraz st_coordinates z pakietu sf wsp&lt;-st_coordinates(st_centroid(dane)) Wspórzdne te pozwol nam nanie etykiety województw w formie ich nazw i wartoci analizowanej zmiennej. par(mar=rep(0,4),mai=rep(0,4)) plot(dane[&quot;UN_RATE&quot;],col=kol_klas, main=&quot;&quot;) text(x=13,y=55,&quot;Mapa 1. Stopa bezrobocia&quot;,cex=0.8) text(x=14.15,y=54.8,&quot;Stan w kocu grudnia 2020 r.&quot;,cex=0.8) text(x=13.2,y=54.6,&quot;Map 1. Unemployment rate&quot;,cex=0.8) text(x=14.3,y=54.4,&quot;As of the end of December 2020&quot;,cex=0.8) text(x=13.3,y=52.4,&quot;Polska = 6,2%&quot;,cex=0.8) text(x=12.9,y=52.2,&quot;Poland&quot;,cex=0.8) text(x=wsp[,1],y=wsp[,2],labels=dane$NAME_1,cex=0.8) text(x=wsp[,1],y=wsp[,2]*1.003,labels=dane$UN_RATE,cex=0.6) legend(&quot;bottomleft&quot;, c(paste0(&quot;[&quot;, klasy$brks[1], &quot; - &quot;, klasy$brks[2], &quot;]&quot;), paste0(&quot;[&quot;, klasy$brks[2], &quot; - &quot;,klasy$brks[3], &quot;]&quot;), paste0(&quot;[&quot;, klasy$brks[3], &quot; - &quot;,klasy$brks[4], &quot;]&quot;), paste0(&quot;[&quot;, klasy$brks[4], &quot; - &quot;,klasy$brks[5], &quot;]&quot;)), fill=attr(kol_klas, &quot;palette&quot;), cex=1, bty=&quot;n&quot;,title = &quot;%&quot;) "],["tworzenie-prostego-kartogramu-zadanie-2.html", "Tworzenie prostego kartogramu - zadanie 2", " Tworzenie prostego kartogramu - zadanie 2 Na bazie kartogramu z zadania 1 Tworzenie prostego kartogramu - zadanie 1, zmodyfikuj go dodajc: tytu wykresu, nazwy gmin, wartoci zmiennych, liczb obiektów w legendzie. "]]
